

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>File Handlers &mdash; pewtils 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="HTTP Utilities" href="http.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pewtils
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#about">About</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#pewtils">PewTils</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#table-of-contents">Table of Contents</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pewtils_core.html">pewtils Core</a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html">HTTP Utilities</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">File Handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and Tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pewtils_core.html">pewtils Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="http.html">HTTP Utilities</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">File Handlers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pewtils</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>File Handlers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/file_handler.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="file-handlers">
<h1>File Handlers<a class="headerlink" href="#file-handlers" title="Permalink to this headline">¶</a></h1>
<p>FileHandler is a class object in pewtils designed to make it easy to read/write data
files in a variety of formats, in both local environment and aws s3.</p>
<span class="target" id="module-pewtils.io"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewtils.io.FileHandler" title="pewtils.io.FileHandler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FileHandler</span></code></a>(path[, use_s3, aws_access, …])</p></td>
<td><p>Read/write data files in a variety of formats, locally and in s3.</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="pewtils.io.FileHandler">
<em class="property">class </em><code class="sig-name descname">FileHandler</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">use_s3=None</em>, <em class="sig-param">aws_access=None</em>, <em class="sig-param">aws_secret=None</em>, <em class="sig-param">bucket=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewtils/io.html#FileHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewtils.io.FileHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Read/write data files in a variety of formats, locally and in s3. File extensions are standardized to promote consistency (e.g., Pickle files must have the extension “.pkl”, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – The path to the folder that you’ll be writing to or reading from</p></li>
<li><p><strong>use_s3</strong> – Whether the path is an S3 location or local location</p></li>
<li><p><strong>aws_access</strong> – The AWS access key; will also try to fetch it from the environment parameter AWS_ACCESS_KEY_ID</p></li>
<li><p><strong>aws_secret</strong> – The AWS secret token; will also try to fetch from the environment as AWS_SECRET_ACCESS_KEY</p></li>
<li><p><strong>bucket</strong> – The name of the S3 bucket; required if use_s3=True; will also try to fetch from the environment as S3_BUCKET</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewtils.io.FileHandler.clear_file" title="pewtils.io.FileHandler.clear_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_file</span></code></a>(key[, format, hash_key])</p></td>
<td><p>Deletes a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewtils.io.FileHandler.clear_folder" title="pewtils.io.FileHandler.clear_folder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_folder</span></code></a>()</p></td>
<td><p>Deletes the path (if local) or unlinks all keys in the bucket folder (if S3)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewtils.io.FileHandler.get_key_hash" title="pewtils.io.FileHandler.get_key_hash"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_key_hash</span></code></a>(key)</p></td>
<td><p>Converts a key to a hashed representation; useful for caching</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewtils.io.FileHandler.iterate_path" title="pewtils.io.FileHandler.iterate_path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iterate_path</span></code></a>()</p></td>
<td><p>Iterates over the directory and returns a list of filenames or S3 object keys</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewtils.io.FileHandler.read" title="pewtils.io.FileHandler.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(key[, format, hash_key])</p></td>
<td><p>Reads a file from the directory, returning its contents.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewtils.io.FileHandler.write" title="pewtils.io.FileHandler.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(key, data[, format, hash_key, …])</p></td>
<td><p>Writes arbitrary data objects to a variety of file formats.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pewtils.io.FileHandler.iterate_path">
<code class="sig-name descname">iterate_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewtils/io.html#FileHandler.iterate_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewtils.io.FileHandler.iterate_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates over the directory and returns a list of filenames or S3 object keys</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Yields a list of filenames or S3 keys</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pewtils.io.FileHandler.clear_folder">
<code class="sig-name descname">clear_folder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewtils/io.html#FileHandler.clear_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewtils.io.FileHandler.clear_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the path (if local) or unlinks all keys in the bucket folder (if S3)</p>
</dd></dl>

<dl class="method">
<dt id="pewtils.io.FileHandler.clear_file">
<code class="sig-name descname">clear_file</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">format='pkl'</em>, <em class="sig-param">hash_key=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewtils/io.html#FileHandler.clear_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewtils.io.FileHandler.clear_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The name of the file.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pewtils.io.FileHandler.get_key_hash">
<code class="sig-name descname">get_key_hash</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewtils/io.html#FileHandler.get_key_hash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewtils.io.FileHandler.get_key_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a key to a hashed representation; useful for caching</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – A raw string</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A SHA224 hash representation of that key</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pewtils.io.FileHandler.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">data</em>, <em class="sig-param">format='pkl'</em>, <em class="sig-param">hash_key=False</em>, <em class="sig-param">add_timestamp=False</em>, <em class="sig-param">**io_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewtils/io.html#FileHandler.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewtils.io.FileHandler.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes arbitrary data objects to a variety of file formats.</p>
<div class="line-block">
<div class="line">If you save something to csv/tab/xlsx/xls/dta, it assumes you’ve passed it a Pandas DataFrame object.         If you’re trying to save an object to JSON, it assumes that you’re passing it valid JSON. By default, though,         the handler attempts to use pickling, allowing you to save (mostly) anything you want.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The name of the file or key (without a file suffix!)</p></li>
<li><p><strong>data</strong> – The actual data to write to the file</p></li>
<li><p><strong>format</strong> – The format the data should be saved in (pkl/csv/tab/xlsx/xls/dta/json). Defaults to pkl.         This will be used as the file’s suffix.</p></li>
<li><p><strong>hash_key</strong> – Whether or not to hash the provided key before saving the file. (Default=False)</p></li>
<li><p><strong>add_timestamp</strong> – Optionally add a timestamp to the filename</p></li>
<li><p><strong>io_kwargs</strong> – Additional parameters to pass along to the save function, which depends on the format of         the file you want to save.  The “dta” format uses <cite>pandas.DataFrame.to_stata</cite>; csv uses <cite>to_csv</cite>; pkl uses         <cite>pickle.dumps</cite>; json uses <cite>json.dumps</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pewtils.io.FileHandler.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">format='pkl'</em>, <em class="sig-param">hash_key=False</em>, <em class="sig-param">**io_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewtils/io.html#FileHandler.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewtils.io.FileHandler.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a file from the directory, returning its contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The name of the file to read (without a suffix!)</p></li>
<li><p><strong>format</strong> – The format of the file (pkl/json/csv/dta/xls/xlsx/tab); expects the file extension to match</p></li>
<li><p><strong>hash_key</strong> – Whether the key should be hashed prior to looking for and retrieving the file.</p></li>
<li><p><strong>io_kwargs</strong> – Optional arguments to be passed to the specific load function (dependent on file format)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The file contents, in the requested format</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="http.html" class="btn btn-neutral float-left" title="HTTP Utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, pew research center

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>